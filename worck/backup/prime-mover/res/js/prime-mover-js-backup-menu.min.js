!function(r){r(function(){var e=r(window);i.initialize(),i.deleteBackups(),i.copyURLToClipBoard(),i.cleanUpUrlAfterBackupRefresh(),i.warnFreeBackupRestoration(),i.checkWidth(e),i.narrowScreens(e)});var i={narrowScreens:function(e){e.resize(function(){i.checkWidth(e)})},checkWidth:function(e){e=e.width();768<e&&e<1280?(r(".js-prime-mover-download-button-backup").html('<span class="dashicons dashicons-download"></span>'),r(".js-prime-mover-restore-icon").html('<span class="dashicons dashicons-backup"></span>'),r(".js-prime-mover-clipboard-button-responsive").html('<span class="dashicons dashicons-migrate"></span>')):(r(".js-prime-mover-download-button-backup").html(prime_mover_js_backups_renderer.download_text),r(".js-prime-mover-restore-icon").html(prime_mover_js_backups_renderer.restore_package_text),r(".js-prime-mover-clipboard-button-responsive").html(prime_mover_js_backups_renderer.copy_restore_url))},cleanUpUrlAfterBackupRefresh:function(){r(window).load(function(){i.maybeCleanUpUrl()&&window.history.replaceState({},"Title",prime_mover_js_backups_renderer.backup_menu_url)})},maybeCleanUpUrl:function(){var e="prime_mover_refresh_backups",o=window.location.href;return-1!=o.indexOf("?"+e+"=")||-1!=o.indexOf("&"+e+"=")},initialize:function(){r("body").on("click",".js-prime-mover-clear-site",function(e){r(".js-prime-mover-site-selector").val("")}),r(".js-prime-mover-site-selector").change(function(){r(this).closest("form").submit()})},deleteBackups:function(){r("body").on("click","#doaction, #doaction2",function(e){var o=r("#bulk-action-selector-top").val();"-1"===o&&(o=r("#bulk-action-selector-bottom").val()),"delete"===o&&0!==r("input[name='prime_mover_backup[]']:checkbox:checked").length&&(e.preventDefault(),o="#js-prime-mover-confirm-backups-delete",e=prime_mover_js_backups_renderer.deleteBackupFileWarning,r(o+" span").html(e),i.showDeleteDialog(o))})},warnFreeBackupRestoration:function(){r("body").on("click",".js-prime-mover-restore-free-backups",function(e){e.preventDefault();var o,e=r(this).attr("href");"readonly"===prime_mover_js_backups_renderer.prime_mover_config_writable?(o="#js-prime-mover-block-free-restore-cached-enabled",i.showCachingEnabledErrorRestoreDialog(o)):(o="#js-prime-mover-confirm-backups-free-restore",i.showFreeBackupRestoreDialog(o,e))})},showCachingEnabledErrorRestoreDialog:function(e){r(e).dialog({resizable:!1,height:"auto",minWidth:320,dialogClass:"prime-mover-user-dialog",maxWidth:600,modal:!0,fluid:!0,buttons:[{text:prime_mover_js_backups_renderer.cancelbutton,class:"button-primary",click:function(){r(this).dialog("close")}}],open:function(e,o){r(".prime-mover-user-dialog button").blur()}}),i.handle_responsive_dialog()},showFreeBackupRestoreDialog:function(e,o){r(e).dialog({resizable:!1,height:"auto",minWidth:320,dialogClass:"prime-mover-user-dialog",maxWidth:600,modal:!0,fluid:!0,buttons:[{text:prime_mover_js_backups_renderer.freerestorebutton,class:"button-primary",click:function(){window.location=o}},{text:prime_mover_js_backups_renderer.cancelbutton,click:function(){r(this).dialog("close")}}],open:function(e,o){r(".prime-mover-user-dialog button").blur()}}),i.handle_responsive_dialog()},showDeleteDialog:function(e){r(e).dialog({resizable:!1,height:"auto",minWidth:320,dialogClass:"prime-mover-user-dialog",maxWidth:600,modal:!0,fluid:!0,buttons:[{text:prime_mover_js_backups_renderer.deletebutton,class:"button button-primary",click:function(){r("#prime_mover_backups-filter").submit()}},{text:prime_mover_js_backups_renderer.cancelbutton,click:function(){r(this).dialog("close")}}],open:function(e,o){r(".prime-mover-user-dialog button").blur()}}),i.handle_responsive_dialog()},fluidDialog:function(){r(".ui-dialog:visible").each(function(){var e,o=r(this),i=o.find(".ui-dialog-content").data("ui-dialog");i.options.fluid&&(r(window).width()<parseInt(i.options.maxWidth)+50?o.css("max-width","90%"):(e=.9*parseInt(i.options.maxWidth),o.css("max-width",e+"px")),i.option("position",i.options.position))})},copyURLToClipBoard:function(){new ClipboardJS(".js-prime-mover-copy-clipboard-menu").on("success",function(e){e=r(e.trigger).attr("data-clipboard-id");r("#"+e).fadeIn("fast").delay(3e3).fadeOut()})},handle_responsive_dialog:function(){r(window).resize(function(){i.fluidDialog()}),i.fluidDialog()}}}(jQuery);